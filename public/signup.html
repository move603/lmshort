<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Signup - SecureLink</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Vercel Speed Insights -->
    <script src="/init-speed-insights.js" defer></script>
</head>
<body class="bg-gray-50 min-h-screen">
  <nav class="gradient-bg text-white shadow-lg sticky top-0 z-50">
    <div class="container mx-auto px-4 py-4">
      <div class="flex justify-between items-center">
        <div class="flex items-center space-x-3">
          <i class="fas fa-link text-3xl"></i>
          <span class="text-3xl font-bold">SecureLink</span>
        </div>
        <div class="flex space-x-4">
          <a href="/" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-4 py-2 rounded-lg transition">
            <i class="fas fa-home mr-1"></i> Home
          </a>
          <a href="/login" class="bg-white text-purple-600 px-4 py-2 rounded-lg font-semibold hover:bg-purple-100 transition">
            <i class="fas fa-sign-in-alt mr-1"></i> Login
          </a>
        </div>
      </div>
    </div>
  </nav>

  <div class="container mx-auto px-4 py-12">
    <div class="max-w-md mx-auto fade-in">
      <div class="bg-white rounded-2xl shadow-2xl p-8">
        <div class="text-center mb-8">
          <i class="fas fa-user-plus text-6xl gradient-bg bg-clip-text text-transparent mb-4"></i>
          <h2 class="text-3xl font-bold text-gray-800">Create Account</h2>
          <p class="text-gray-600 mt-2">Join SecureLink today</p>
        </div>
        <div class="space-y-5">
          <div>
            <label class="block text-gray-800 font-bold mb-2"><i class="fas fa-user text-blue-600"></i> Full Name</label>
            <input type="text" id="signupName" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg text-gray-900" placeholder="John Doe" autocomplete="name">
          </div>
          <div>
            <label class="block text-gray-800 font-bold mb-2"><i class="fas fa-envelope text-purple-600"></i> Email</label>
            <input type="email" id="signupEmail" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg text-gray-900" placeholder="your@email.com" autocomplete="email">
          </div>
          <div>
            <label class="block text-gray-800 font-bold mb-2"><i class="fas fa-key text-green-600"></i> Password</label>
            <input type="password" id="signupPassword" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg text-gray-900" placeholder="Create strong password" autocomplete="new-password">
          </div>
          <button id="signupBtn" class="w-full gradient-bg text-white py-4 rounded-lg font-bold text-lg hover:shadow-xl transition">
            <i class="fas fa-user-check mr-2"></i> Create Account
          </button>
          <div class="text-center pt-2">
            <a href="/login" class="text-purple-600 hover:text-purple-800 font-semibold text-lg">Already have an account? <strong>Sign in</strong></a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="toastContainer" class="fixed top-4 right-4 z-50 space-y-3"></div>

  <script>
    window.API_BASE = window.location.origin;
    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      const colors = { success: 'bg-green-500', error: 'bg-red-500', info: 'bg-blue-500' };
      toast.className = `${colors[type]} px-6 py-4 rounded-xl shadow-2xl text-white flex items-center space-x-3 min-w-[300px]`;
      toast.innerHTML = `<i class="fas ${type === 'error' ? 'fa-exclamation-circle' : 'fa-check-circle'} text-2xl"></i><span class="font-semibold">${message}</span>`;
      document.getElementById('toastContainer').appendChild(toast);
      setTimeout(() => { toast.style.opacity = '0'; setTimeout(() => toast.remove(), 300); }, 4000);
    }

    document.getElementById('signupBtn').addEventListener('click', async () => {
      const name = document.getElementById('signupName').value.trim();
      const email = document.getElementById('signupEmail').value.trim();
      const password = document.getElementById('signupPassword').value.trim();
      if (!name || !email || !password) { showToast('Please fill in all fields', 'error'); return; }
      try {
        const response = await fetch(`${API_BASE}/api/auth?type=register`, {
          method: 'POST', headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
          body: JSON.stringify({ name, email, password, captchaAnswer: 0, captchaCorrect: 0 })
        });
        let data; try { data = await response.json(); } catch { const text = await response.text(); throw new Error(text || 'Unexpected server response'); }
        if (!response.ok) throw new Error(data.error || 'Signup failed');
        localStorage.setItem('authToken', data.user.token);
        showToast('Account created successfully! ðŸŽ‰', 'success');
        window.location.href = '/dashboard';
      } catch (e) { showToast(e.message, 'error'); }
    });
  </script>
</body>
</html>
